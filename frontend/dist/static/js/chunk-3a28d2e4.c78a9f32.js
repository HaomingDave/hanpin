(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a28d2e4"],{"371d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app-container"},[a("el-form",{ref:"form",attrs:{model:e.row,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"项目名",prop:"name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.row.name,callback:function(t){e.$set(e.row,"name",t)},expression:"row.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目经理"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:e.userInfo&&"shenhe001"!==e.userInfo.username},model:{value:e.row.manager,callback:function(t){e.$set(e.row,"manager",t)},expression:"row.manager"}},e._l(e.managerList,(function(e){return a("el-option",{key:e.user_id,attrs:{label:e.nickname,value:e.user_id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"开始时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期时间",size:"small"},model:{value:e.row.start_time,callback:function(t){e.$set(e.row,"start_time",t)},expression:"row.start_time"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目缩略图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.assetsUrl+"/QPpNbWlorZ.php/ajax/upload","show-file-list":!1,"with-credentials":"","on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,size:"small"}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.assetsUrl+e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"工期"}},[a("el-input",{attrs:{size:"small"},model:{value:e.row.gong_qi,callback:function(t){e.$set(e.row,"gong_qi",t)},expression:"row.gong_qi"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否超期"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.row.is_overdue,callback:function(t){e.$set(e.row,"is_overdue",t)},expression:"row.is_overdue"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"0"},model:{value:e.row.is_overdue,callback:function(t){e.$set(e.row,"is_overdue",t)},expression:"row.is_overdue"}},[e._v("否")])],1),e._v(" "),a("el-form-item",{attrs:{label:"项目备注信息"}},[a("el-input",{attrs:{type:"textarea",rows:"5",size:"small"},model:{value:e.row.introduction,callback:function(t){e.$set(e.row,"introduction",t)},expression:"row.introduction"}})],1),e._v(" "),a("el-form-item",[!e.userInfo||"shenhe001"!==e.userInfo.username&&e.userInfo.id!==e.originalManager?e._e():a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("修改")]),e._v(" "),e.userInfo&&"shenhe001"===e.userInfo.username?a("el-button",{staticStyle:{float:"right"},attrs:{type:"danger",size:"small"},on:{click:e.onCancel}},[e._v("删除该项目")]):e._e()],1)],1)],1)},o=[],n=a("db72"),s=a("ad8f"),i=a("2f62"),l={data:function(){return{assetsUrl:"http://hanpin.hich-tech.com",row:{name:"",mobile:"",start_time:"",end_time:"",gong_qi:"",image:"",progress:"",introduction:"",order:"",status:"",is_overdue:"0",manager:"",currentUser:""},rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"}]},loading:!1,projectInfo:{},projectInfoOriginal:{},imageUrl:null,originalManager:""}},computed:Object(n["a"])({},Object(i["b"])(["userInfo"])),created:function(){this.fetchData()},methods:{onSubmit:function(){var e=this;this.row.currentUser=this.userInfo.id,this.$refs["form"].validate((function(t){if(!t)return!1;e.loading=!0,e.row.image=e.imageUrl,Object(s["m"])({},e.row,e.$route.query.projectId).then((function(t){console.log(t),e.loading=!1,e.$message({message:"提交成功",type:"success"}),e.$router.push("/")}))}))},onCancel:function(){var e=this;this.$confirm("此操作将删除该项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"删除成功!"}),e.loading=!0,Object(s["g"])({},e.$route.query.projectId).then((function(t){console.log("success"),e.$router.push("/")}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},fetchData:function(){var e=this;this.loading=!0,Object(s["s"])({}).then((function(t){e.managerList=t.data.rows,Object(s["w"])({},e.$route.query.projectId).then((function(t){for(var a in e.projectInfo=t.data,e.projectInfoOriginal=t.data,e.imageUrl=t.data.image,e.row.manager=t.data.manager,e.originalManager=t.data.manager,e.loading=!1,e.row)e.row[a]=e.projectInfo[a];e.row.start_time=e.projectInfo.start_time_text,e.row.end_time=e.projectInfo.end_time_text,e.row.is_overdue=String(e.projectInfo.is_overdue)}))}))},handleAvatarSuccess:function(e,t){this.imageUrl=e.data.url},beforeAvatarUpload:function(){}}},c=l,u=(a("3d9e"),a("2877")),m=Object(u["a"])(c,r,o,!1,null,null,null);t["default"]=m.exports},"3d9e":function(e,t,a){"use strict";var r=a("a583"),o=a.n(r);o.a},a583:function(e,t,a){}}]);