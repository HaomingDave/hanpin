(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aabd46f0"],{9644:function(t,e,a){},ad7d:function(t,e,a){"use strict";var n=a("9644"),i=a.n(n);i.a},f6ec:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"app-container"},[a("div",{staticStyle:{"margin-bottom":"20px"}},[t._v("采购申请表:")]),t._v(" "),-1!==t.userInfo.role.indexOf("6")&&t.userInfo.id===t.originalManager?a("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary",size:"mini",loading:t.addLoading},on:{click:t.addPurchaseApproval}},[t._v("添加采购申请单")]):t._e(),t._v(" "),a("el-table",{key:t.tableKey,attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"ID",prop:"id",sortable:"custom",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.id))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"申请人",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.applicant))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"申请时间",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.applicant_time))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.audit))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"审核时间",width:"160px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.audit_time_text))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"复核时间",width:"160px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.reaudit_time_text))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;e.$index;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.edit(n.id)}}},[t._v("\n          进入\n        ")]),t._v(" "),"待审核"!=n.audit&&"未提交"!=n.audit||-1===t.userInfo.role.indexOf("6")||t.userInfo.id!==t.originalManager?t._e():a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.deleteApproval(n.id)}}},[t._v("\n          删除\n        ")])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.handleCurrentChange}})],1)},i=[],o=a("db72"),r=a("ad8f"),l=a("2f62"),s=10,u={data:function(){return{tableKey:0,loading:!1,addLoading:!1,list:[],total:0,pageSize:s,approvalSubmitData:{name:"default",pid:this.$route.query.projectId,numer:"001",order:0,status:"normal"},originalManager:""}},computed:Object(o["a"])({},Object(l["b"])(["userInfo"])),created:function(){this.fetchData()},methods:{edit:function(t){this.addLoading=!0,this.$router.push({path:"/project/purchaseDetail",query:{projectName:this.$route.query.projectName,projectId:this.$route.query.projectId,applicationId:t}})},handleUpdate:function(t){},handleDelete:function(t){},addPurchaseApproval:function(){var t=this;this.loading=!0,Object(r["a"])({},this.approvalSubmitData).then((function(e){t.loading=!1,t.$message({message:"添加成功",type:"success",duration:2e3,onClose:function(){window.location.reload()}})}))},deleteApproval:function(t){var e=this;this.loading=!0,Object(r["f"])({},t).then((function(t){e.loading=!1,e.$message({message:"删除成功",type:"success",duration:2e3,onClose:function(){window.location.reload()}})}))},onCancel:function(){this.$message({message:"cancel!",type:"warning"})},fetchData:function(t){var e=this;this.loading=!0,Object(r["t"])({pid:this.$route.query.projectId,limit:s,offset:t?(t-1)*s:0}).then((function(t){console.log(t),e.list=t.data.rows,e.total=t.data.total,e.loading=!1})),Object(r["w"])({},this.$route.query.projectId).then((function(t){e.originalManager=t.data.manager}))},handleCurrentChange:function(t){console.log(t),this.fetchData(t)}}},d=u,c=(a("ad7d"),a("2877")),p=Object(c["a"])(d,n,i,!1,null,"5ad14f36",null);e["default"]=p.exports}}]);